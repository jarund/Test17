<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="stock_picking_type_kanban" model="ir.ui.view">
        <field name="name">stock.picking.type.kanban</field>
        <field name="model">stock.picking.type</field>
        <field name="inherit_id" ref="stock.stock_picking_type_kanban"/>
        <field name="arch" type="xml">
            <xpath expr="//div[hasclass('o_kanban_card_content')]" position="inside">
                <div class="o_kanban_manage_new">
                    <button name="%(stock.action_picking_form)d" type="action"
                            class="btn btn-primary"
                            context="{'default_immediate_transfer': True}">Create</button>
                </div>
            </xpath>
        </field>
    </record>

    <record id="view_stock_move_line_detailed_operation_tree" model="ir.ui.view">
        <field name="name">stock.move.line.operations.tree</field>
        <field name="model">stock.move.line</field>
        <field name="inherit_id" ref="stock.view_stock_move_line_detailed_operation_tree"/>
        <field name="arch" type="xml">
            <field name="product_id" position="after">
                <field name="scrap_id" invisible="1"/>
            </field>
            <field name="lot_id" position="replace">
                <field name="picking_code" invisible="1"/>
                <field name="lot_id"
                       groups="stock.group_production_lot"
                       attrs="{'column_invisible': [('parent.show_lots_text', '=', True)], 'invisible': [('lots_visible', '=', False)]}"
                       context="{'default_product_id': product_id,
                                 'default_company_id': company_id,
                                 'active_picking_id': active_id,
                                 'default_picking_type_id':parent.picking_type_id,
                                 'picking_code': picking_code,
                                 'lot_search': True}"
                       optional="show"/>
            </field>
            <field name="product_uom_id" position="after">
                <field name="receipt_picking_id" readonly="1" optional="hide"/>
                <field name="adjust_quantity" readonly="1" optional="hide"/>
            </field>
        </field>
    </record>

    <record id="view_picking_form" model="ir.ui.view">
        <field name="name">stock.picking.form</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_form"/>
        <field name="arch" type="xml">
            <field name="origin" position="after">
                <field name="barcode" widget="barcode_handler"/>
<!--                <field name="warn" nolabel="1" attrs="{'invisible': [('warn', '=', False)]}" class="text-danger"/>-->
            </field>
            <xpath expr="//field[@name='move_ids_without_package']//tree//field[@name='product_id']" position="replace">
                <field name="scrap_id"/>
                <field name="product_id"
                       domain="[('categ_id', '=', scrap_id)]"
                       required="1"
                       context="{'default_type': 'product'}"
                       attrs="{'readonly': ['|', '&amp;', ('state', '!=', 'draft'), ('additional', '=', False), ('has_move_lines', '=', True)]}"/>
            </xpath>
        </field>
    </record>

</odoo>